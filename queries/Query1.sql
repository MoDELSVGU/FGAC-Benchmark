DROP PROCEDURE IF EXISTS NativeQuery1;
DELIMITER //
CREATE PROCEDURE NativeQuery1
(in caller varchar(250), in role varchar(250))
BEGIN
DECLARE _rollback int DEFAULT 0;
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
  SET _rollback = 1;
  GET STACKED DIAGNOSTICS CONDITION 1 
    @p1 = RETURNED_SQLSTATE, @p2 = MESSAGE_TEXT;
  SELECT @p1, @p2;
  ROLLBACK;
  END;
  START TRANSACTION;
  IF _rollback = 0
    THEN SELECT COUNT(*) FROM Student WHERE age > 18;
  END IF;
END //
DELIMITER ;